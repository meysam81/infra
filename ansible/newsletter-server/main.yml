- name: Newsletter Server
  hosts: hcloud
  gather_facts: false
  become: true
  tasks:
    - name: Update HAProxy config
      ansible.builtin.copy:
        src: haproxy.cfg
        dest: /etc/haproxy/haproxy.cfg
        owner: haproxy
        group: haproxy
        mode: "0644"
      notify: Reload haproxy
  handlers:
    - name: Reload haproxy
      ansible.builtin.systemd:
        name: haproxy
        state: reloaded
        daemon_reload: true
