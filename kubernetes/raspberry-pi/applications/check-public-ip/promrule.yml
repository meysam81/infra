apiVersion: operator.victoriametrics.com/v1beta1
kind: VMRule
metadata:
  name: check-public-ip
spec:
  groups:
    - name: check-public-ip
      interval: 30s
      rules:
        - alert: IpChanged
          expr: count by (ip_address) (public_ip) > 1
          for: 2m
          labels:
            severity: warning
          annotations:
            summary: Public IP address changed
            description: >-
              The public IP address of instance {{ $labels.instance }} has
              changed in the last minute to {{ $labels.ip_address }}
